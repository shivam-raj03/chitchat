{"ast":null,"code":"import _toConsumableArray from\"/Users/shivamrajput/Desktop/Web Dev/Chatchord/client/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js\";import _slicedToArray from\"/Users/shivamrajput/Desktop/Web Dev/Chatchord/client/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";/*eslint-disable*/import React,{useEffect,useState}from'react';import{useLocation}from'react-router-dom';import queryString from'query-string';import io from'socket.io-client';import InfoBar from'../InfoBar/InfoBar';import Input from'../Input/Input';import Messages from'../Messages/Messages';import TextContainer from'../TextContainer/TextContainer';import'./Chat.css';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var socket;var Chat=function Chat(){var location=useLocation();var _useState=useState(''),_useState2=_slicedToArray(_useState,2),name=_useState2[0],setName=_useState2[1];var _useState3=useState(''),_useState4=_slicedToArray(_useState3,2),room=_useState4[0],setRoom=_useState4[1];var _useState5=useState(''),_useState6=_slicedToArray(_useState5,2),message=_useState6[0],setMessage=_useState6[1];var _useState7=useState([]),_useState8=_slicedToArray(_useState7,2),messages=_useState8[0],setMessages=_useState8[1];var _useState9=useState(''),_useState10=_slicedToArray(_useState9,2),users=_useState10[0],setUsers=_useState10[1];var ENDPOINT='localhost:4000';useEffect(function(){var _queryString$parse=queryString.parse(location.search),name=_queryString$parse.name,room=_queryString$parse.room;socket=io(ENDPOINT);setName(name);setRoom(room);socket.emit('join',{name:name,room:room},function(){var err=arguments.length>0&&arguments[0]!==undefined?arguments[0]:'successfully joined';console.log(err);});//console.log(socket);\nreturn function(){socket.emit('disconnect');socket.off();};},[ENDPOINT,location.search]);useEffect(function(){//console.log('hello');\nsocket.on('message',function(message){setMessages([].concat(_toConsumableArray(messages),[message]));});},[messages]);var sendMessage=function sendMessage(evt){evt.preventDefault();if(message){socket.emit('sendMessage',message,function(){return setMessage('');});}};//console.log(message);\n//console.log(messages);\nreturn/*#__PURE__*/_jsxs(\"div\",{className:\"outerContainer\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"container\",children:[/*#__PURE__*/_jsx(InfoBar,{room:room}),/*#__PURE__*/_jsx(Messages,{messages:messages,name:name}),/*#__PURE__*/_jsx(Input,{message:message,setMessage:setMessage,sendMessage:sendMessage})]}),/*#__PURE__*/_jsx(TextContainer,{users:users})]});};export default Chat;","map":{"version":3,"names":["React","useEffect","useState","useLocation","queryString","io","InfoBar","Input","Messages","TextContainer","jsx","_jsx","jsxs","_jsxs","socket","Chat","location","_useState","_useState2","_slicedToArray","name","setName","_useState3","_useState4","room","setRoom","_useState5","_useState6","message","setMessage","_useState7","_useState8","messages","setMessages","_useState9","_useState10","users","setUsers","ENDPOINT","_queryString$parse","parse","search","emit","err","arguments","length","undefined","console","log","off","on","concat","_toConsumableArray","sendMessage","evt","preventDefault","className","children"],"sources":["/Users/shivamrajput/Desktop/Web Dev/Chatchord/client/src/components/chat/Chat.js"],"sourcesContent":["/*eslint-disable*/\nimport React, { useEffect, useState} from 'react';\nimport { useLocation } from 'react-router-dom';\nimport queryString from 'query-string';\nimport io from 'socket.io-client';\n\nimport InfoBar from '../InfoBar/InfoBar';\nimport Input from '../Input/Input';\nimport Messages from '../Messages/Messages';\nimport TextContainer from '../TextContainer/TextContainer';\n\nimport './Chat.css';\n\nlet socket;\n\nconst Chat = () => {\n  const location = useLocation();\n  const [name, setName] = useState('');\n  const [room, setRoom] = useState('');\n  const [message, setMessage] = useState('');\n  const [messages, setMessages] = useState([]);\n  const [users, setUsers] = useState('');\n\n  const ENDPOINT = 'localhost:4000';\n  \n  useEffect(() => {\n    const { name, room } = queryString.parse(location.search);\n    \n    socket = io(ENDPOINT);\n\n    setName(name);\n    setRoom(room);\n\n    socket.emit('join', { name, room}, (err = 'successfully joined') => {\n      console.log(err);\n    });\n\n    //console.log(socket);\n\n     return () => {\n      socket.emit('disconnect');\n      socket.off();\n     }\n  }, [ENDPOINT, location.search]);\n\n  useEffect(() => {\n      //console.log('hello');\n      socket.on('message', (message) =>{\n        setMessages([...messages, message]);\n      });\n  }, [messages]);\n\n  const sendMessage = evt => {\n    evt.preventDefault();\n    if(message){\n      socket.emit('sendMessage', message, () => setMessage(''));\n    }\n  }\n  //console.log(message);\n  //console.log(messages);\n  return (\n\n    <div className='outerContainer'>\n        <div className='container'>\n            <InfoBar room={room} />\n            <Messages messages={messages} name={name}/>\n            <Input message={message} setMessage={setMessage} sendMessage={sendMessage} />\n        </div>\n        <TextContainer users={users} />\n    </div>\n  )\n}\n\nexport default Chat;\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}